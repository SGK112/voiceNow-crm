@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    --background: 0 0% 100%;
    --foreground: 222.2 84% 4.9%;
    --card: 0 0% 100%;
    --card-foreground: 222.2 84% 4.9%;
    --popover: 0 0% 100%;
    --popover-foreground: 222.2 84% 4.9%;
    --primary: 221.2 83.2% 53.3%;
    --primary-foreground: 210 40% 98%;
    --secondary: 210 40% 96.1%;
    --secondary-foreground: 222.2 47.4% 11.2%;
    --muted: 210 40% 96.1%;
    --muted-foreground: 215.4 16.3% 46.9%;
    --accent: 210 40% 96.1%;
    --accent-foreground: 222.2 47.4% 11.2%;
    --destructive: 0 84.2% 60.2%;
    --destructive-foreground: 210 40% 98%;
    --border: 214.3 31.8% 91.4%;
    --input: 214.3 31.8% 91.4%;
    --ring: 221.2 83.2% 53.3%;
    --radius: 0.5rem;
  }

  .dark {
    --background: 224 71% 4%;
    --foreground: 213 31% 91%;
    --card: 224 71% 10%;
    --card-foreground: 213 31% 91%;
    --popover: 224 71% 10%;
    --popover-foreground: 213 31% 91%;
    --primary: 217.2 91.2% 59.8%;
    --primary-foreground: 222.2 47.4% 1.2%;
    --secondary: 222.2 47.4% 11.2%;
    --secondary-foreground: 210 40% 98%;
    --muted: 223 47% 11%;
    --muted-foreground: 215.4 16.3% 70%;
    --accent: 216 34% 17%;
    --accent-foreground: 210 40% 98%;
    --destructive: 0 63% 31%;
    --destructive-foreground: 210 40% 98%;
    --border: 216 34% 17%;
    --input: 216 34% 17%;
    --ring: 217.2 91.2% 59.8%;
  }
}

@layer base {
  * {
    @apply border-border;
  }
  body {
    @apply bg-background text-foreground;
  }

  /* Hide scrollbars globally but keep functionality */
  * {
    scrollbar-width: none; /* Firefox */
    -ms-overflow-style: none; /* IE and Edge */
  }

  *::-webkit-scrollbar {
    display: none; /* Chrome, Safari, Opera */
  }

  /* MOBILE-FIRST CRITICAL FIXES */
  html, body, #root {
    max-width: 100vw;
    overflow-x: hidden;
  }

  * {
    max-width: 100%;
    box-sizing: border-box;
  }
}

/* ============================================
   MOBILE-FIRST OVERRIDES (OUTSIDE @layer)
   These have higher specificity than Tailwind
   ============================================ */

/* Prevent horizontal scroll */
html {
  overflow-x: hidden !important;
  max-width: 100vw !important;
}

body {
  overflow-x: hidden !important;
  max-width: 100vw !important;
}

/* All containers respect viewport */
.container,
main,
[class*="container"] {
  max-width: 100% !important;
  overflow-x: hidden !important;
}

/* Mobile-optimized buttons - CRITICAL */
button,
[type="button"],
[type="submit"],
.btn,
[class*="button"] {
  min-height: 44px !important;
  min-width: 44px !important;
  padding: 10px 16px !important;
  font-size: 15px !important;
  -webkit-tap-highlight-color: transparent !important;
  touch-action: manipulation !important;
}

/* Forms - prevent iOS zoom */
input,
textarea,
select {
  font-size: 16px !important;
  min-height: 44px !important;
  padding: 12px !important;
  -webkit-appearance: none !important;
}

textarea {
  min-height: 120px !important;
}

/* Mobile responsive text */
h1 {
  font-size: clamp(24px, 6vw, 36px) !important;
  line-height: 1.2 !important;
}

h2 {
  font-size: clamp(20px, 5vw, 30px) !important;
  line-height: 1.3 !important;
}

h3 {
  font-size: clamp(18px, 4vw, 24px) !important;
}

p {
  font-size: clamp(14px, 3vw, 16px) !important;
  line-height: 1.6 !important;
}

/* Tables to cards on mobile */
@media (max-width: 768px) {
  table {
    display: block !important;
    overflow-x: auto !important;
  }

  table thead {
    display: none !important;
  }

  table tbody,
  table tr {
    display: block !important;
    width: 100% !important;
    margin-bottom: 16px !important;
  }

  table tr {
    padding: 16px !important;
    border-radius: 8px !important;
    background: hsl(var(--card)) !important;
    border: 1px solid hsl(var(--border)) !important;
  }

  table td {
    display: flex !important;
    justify-content: space-between !important;
    padding: 8px 0 !important;
    border-bottom: 1px solid hsl(var(--border)) !important;
  }

  table td:last-child {
    border-bottom: none !important;
  }
}

/* Grids responsive */
.grid {
  display: grid !important;
  grid-template-columns: 1fr !important;
  gap: 16px !important;
}

@media (min-width: 640px) {
  .grid-cols-2,
  [class*="grid-cols-2"] {
    grid-template-columns: repeat(2, 1fr) !important;
  }
}

@media (min-width: 1024px) {
  .grid-cols-3,
  [class*="grid-cols-3"] {
    grid-template-columns: repeat(3, 1fr) !important;
  }

  .grid-cols-4,
  [class*="grid-cols-4"] {
    grid-template-columns: repeat(4, 1fr) !important;
  }
}

/* Modals mobile-friendly */
[role="dialog"],
.modal {
  width: calc(100% - 32px) !important;
  max-width: 600px !important;
  max-height: calc(100vh - 32px) !important;
  margin: 16px auto !important;
  overflow-y: auto !important;
}

/* Images responsive */
img,
video,
iframe {
  max-width: 100% !important;
  height: auto !important;
}

/* ============================================
   CRM PAGE MOBILE FIXES
   ============================================ */

/* Hide CRM sidebar on mobile, show as dropdown instead */
@media (max-width: 1024px) {
  /* Main CRM container - remove flex, stack vertically */
  [class*="h-"][class*="calc"] {
    display: block !important;
    height: auto !important;
    min-height: 100vh !important;
  }

  /* CRM Sidebar - hide on mobile */
  .w-64 {
    display: none !important;
  }

  /* CRM main content - full width on mobile */
  .flex-1 {
    width: 100% !important;
    padding: 16px !important;
  }

  /* Pipeline columns - horizontal scroll */
  .overflow-x-auto {
    -webkit-overflow-scrolling: touch !important;
    scroll-snap-type: x mandatory !important;
  }

  .overflow-x-auto > div {
    min-width: 280px !important;
    flex-shrink: 0 !important;
    scroll-snap-align: start !important;
  }
}

/* ============================================
   DASHBOARD & STATS MOBILE FIXES
   ============================================ */

/* Stats cards - stack on mobile */
@media (max-width: 768px) {
  [class*="grid-cols-"] {
    grid-template-columns: 1fr !important;
  }
}

@media (min-width: 640px) and (max-width: 1023px) {
  [class*="grid-cols-3"],
  [class*="grid-cols-4"] {
    grid-template-columns: repeat(2, 1fr) !important;
  }
}

/* ============================================
   LAYOUT COMPONENTS MOBILE FIXES
   ============================================ */

/* Main content padding */
@media (max-width: 768px) {
  main {
    padding: 12px !important;
  }

  [class*="p-6"],
  [class*="p-8"] {
    padding: 16px !important;
  }

  [class*="px-6"],
  [class*="px-8"] {
    padding-left: 16px !important;
    padding-right: 16px !important;
  }

  [class*="py-6"],
  [class*="py-8"] {
    padding-top: 16px !important;
    padding-bottom: 16px !important;
  }
}

/* ============================================
   BUTTON GROUPS MOBILE FIXES
   ============================================ */

@media (max-width: 640px) {
  /* Stack button groups vertically */
  .flex.gap-2:has(button),
  .flex.gap-3:has(button),
  .flex.gap-4:has(button) {
    flex-direction: column !important;
  }

  .flex.gap-2:has(button) > button,
  .flex.gap-3:has(button) > button,
  .flex.gap-4:has(button) > button {
    width: 100% !important;
  }
}

/* ============================================
   VOICEFLOW BUILDER - ENSURE DESKTOP ONLY
   ============================================ */

@media (max-width: 768px) {
  /* React Flow canvas - show warning on mobile */
  .react-flow {
    display: none !important;
  }

  /* Show mobile warning message */
  .react-flow-wrapper::before {
    content: "VoiceFlow Builder requires a desktop screen. Please use a device with a larger screen to access this feature." !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    text-align: center !important;
    padding: 32px !important;
    background: hsl(var(--card)) !important;
    border: 2px dashed hsl(var(--border)) !important;
    border-radius: 12px !important;
    min-height: 400px !important;
    font-size: 16px !important;
    color: hsl(var(--muted-foreground)) !important;
  }
}

/* ============================================
   SEARCH & FILTER BARS MOBILE
   ============================================ */

@media (max-width: 768px) {
  /* Search bars - full width */
  [type="search"],
  [placeholder*="Search"] {
    width: 100% !important;
  }

  /* Filter dropdowns - full width */
  select,
  [role="combobox"] {
    width: 100% !important;
  }

  /* View toggle buttons - smaller on mobile */
  button[aria-label*="view"] {
    padding: 8px !important;
  }
}
